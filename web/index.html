<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" />
    <meta name="description" content="业余无线电台网点名记录助手 - BG4QBF. 在线记录通联日志, 利用地图可视化数据." />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>业余无线电台网点名记录助手 - BG4QBF</title>
    <link rel="stylesheet" href="css/index.css" />
    {{ with .Key }}
    <script src="http://api.tianditu.gov.cn/api?v=4.0&tk={{ . }}" type="text/javascript"></script>
    <style>
        #logdiv {
            grid-column: 1;
            width: calc(46dvw - 2.4px);
        }

        #mapdiv {
            grid-column: 2;
            grid-row: 1;
            width: calc(46dvw - 2.4px);
            height: calc(41dvh - 2.4px)
        }
    </style>
    {{ else }}
    <style>
        #logdiv {
            grid-column-start: 1;
            grid-column-end: 3;
            width: calc(96dvw - 2.4px);
        }
    </style>
    {{ end }}
    <script src="js/main.js" type="text/javascript" defer></script>
</head>

<body onload="onload()">
    <header>
        HamLogHelper 业余无线电台网点名记录助手
    </header>
    <div id="mainpage">
        <div class="field" id="logdiv">
            <p class="fieldtitle">
                <span>记录&nbsp;</span>
                <a href="#" class="exportlink">导出</a>
                <span id="connected"></span>
                <a href="javascript:void(0);"
                    onclick="localStorage.removeItem('logfilename');window.location.reload();">打开新文件</a>
            </p>
            <div id="logs">
                <table>
                    <thead>
                        <tr>
                            <td>操作</td>
                            <td>位号</td>
                            <td>呼号</td>
                            <td>日期时间</td>
                            <td hidden>频率</td>
                            <td hidden>模式</td>
                            <td>信号</td>
                            <td>对方设备</td>
                            <td>对方天线</td>
                            <td>对方功率</td>
                            <td>对方台址</td>
                            <td hidden>己方设备</td>
                            <td hidden>己方天线</td>
                            <td hidden>己方功率</td>
                            <td hidden>己方台址</td>
                            <td>备注</td>
                        </tr>
                    </thead>
                    <tbody id="logtable"></tbody>
                </table>
            </div>
            <a href="#" class="exportlink">导出</a>
        </div>
        {{ with .Key }}
        <div class="field" id="mapdiv">
        </div>
        {{ end }}
        <div class="field" id="inputdiv">
            <div class="fieldtitle">
                <span id="inputtitle">输入</span>&nbsp;|&nbsp;<a href="javascript:void(0);"
                    onclick="document.querySelectorAll('.hideable').forEach(e => e.hidden = !e.hidden);">显示/隐藏己方信息</a>
            </div>
            <div id="inputs">
                <form tabindex="-1" id="infoform">
                    <div id="formdiv">
                        <input type="number" name="index" id="index" hidden>

                        <label for="callsign" id="callsignlabel">呼号: </label>
                        <input type="text" name="callsign" id="callsign" required>

                        <input type="checkbox" name="dtlock" id="dtlock" value="auto" onclick="auto_dt(this)"
                            tabindex="-1">
                        <label for="dtlock" id="dtlocklabel">自动</label>
                        <label for="dt" id="dtlabel">日期时间: </label>
                        <input type="datetime-local" name="dt" id="dt" min="1900-01-01T00:00" max="2999-12-31T23:59"
                            required>

                        <input type="checkbox" name="freqlock" id="freqlock" value="lock"
                            onclick="click_lock(this, 'freq')" tabindex="-1" class="hideable">
                        <label for="freqlock" id="freqlocklabel" class="hideable">锁定</label>
                        <label for="freq" id="freqlabel" title="接收频率(小数) / +或- 频差(小数), 如430.610/+9.0"
                            class="hideable">频率: </label>
                        <input type="text" name="freq" id="freq" placeholder="438.500/+0.0"
                            title="接收频率(小数) / +或- 频差(小数), 如430.610/+9.0" class="hideable" required>

                        <input type="checkbox" name="modelock" id="modelock" value="lock"
                            onclick="click_lock(this, 'mode')" tabindex="-1" class="hideable">
                        <label for="modelock" id="modelocklabel" class="hideable">锁定</label>
                        <label for="mode" id="modelabel" title="仅允许列表中的模式, 否则无效" class="hideable">模式: </label>
                        <input type="text" name="mode" id="mode" placeholder="FM" title="仅允许列表中的模式, 否则无效"
                            class="hideable" required>

                        <label for="rst" id="rstlabel">信号: </label>
                        <input type="text" name="rst" id="rst" required>

                        <label for="rrig" id="rriglabel">对方设备: </label>
                        <input type="text" name="rrig" id="rrig">

                        <label for="rant" id="rantlabel">对方天线: </label>
                        <input type="text" name="rant" id="rant">

                        <label for="rpwr" id="rpwrlabel">对方功率: </label>
                        <input type="text" name="rpwr" id="rpwr">

                        <label for="rqth" id="rqthlabel">对方台址: </label>
                        <input type="text" name="rqth" id="rqth">

                        <input type="checkbox" name="triglock" id="triglock" value="lock"
                            onclick="click_lock(this, 'trig')" tabindex="-1" class="hideable">
                        <label for="triglock" id="triglocklabel" class="hideable">锁定</label>
                        <label for="trig" id="triglabel" class="hideable">己方设备: </label>
                        <input type="text" name="trig" id="trig" class="hideable" required>

                        <input type="checkbox" name="tantlock" id="tantlock" value="lock"
                            onclick="click_lock(this, 'tant')" tabindex="-1" class="hideable">
                        <label for="tantlock" id="tantlocklabel" class="hideable">锁定</label>
                        <label for="tant" id="tantlabel" class="hideable">己方天线: </label>
                        <input type="text" name="tant" id="tant" class="hideable" required>

                        <input type="checkbox" name="tpwrlock" id="tpwrlock" value="lock"
                            onclick="click_lock(this, 'tpwr')" tabindex="-1" class="hideable">
                        <label for="tpwrlock" id="tpwrlocklabel" class="hideable">锁定</label>
                        <label for="tpwr" id="tpwrlabel" class="hideable">己方功率: </label>
                        <input type="text" name="tpwr" id="tpwr" class="hideable" required>

                        <input type="checkbox" name="tqthlock" id="tqthlock" value="lock"
                            onclick="click_lock(this, 'tqth')" tabindex="-1" class="hideable">
                        <label for="tqthlock" id="tqthlocklabel" class="hideable">锁定</label>
                        <label for="tqth" id="tqthlabel" class="hideable">己方台址: </label>
                        <input type="text" name="tqth" id="tqth" class="hideable" required>

                        <label for="rmks" id="rmkslabel">备注: </label>
                        <input type="text" name="rmks" id="rmks">

                        <input type="submit" name="submit" id="submit" value="提交">

                    </div>
                </form>
            </div>
        </div>
        <div class="field" id="searchdiv">
            <p class="fieldtitle">查询 | <a href="/dbeditor.html">编辑数据库</a>
                <span id="tmpldone"></span><span id="dictdone"></span>
            </p>
            <div id="search">
                <div>
                    <ol id="suggests"></ol>
                </div>
                <div>
                    <ol id="dynamics"></ol>
                </div>
                <div>
                    <ol id="mapsuggests"></ol>
                </div>
            </div>
        </div>
    </div>
    <footer>
        <span>by odorajbotoj (BG4QBF) | MIT License | Copyright (c) 2025-2026 薛子豪 |</span>
        &nbsp;
        {{ with .Version }}
        <span id="version">{{ . }}</span>
        {{ else }}
        <span id="version">ver. u.n.k</span>
        {{ end }}
    </footer>
</body>

</html>
