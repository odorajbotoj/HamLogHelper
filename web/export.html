<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8" />
    <link rel="icon" href="favicon.ico" type="image/x-icon" />
    <title>导出 - 业余无线电通联记录助手 - BG4QBF</title>
    <script type="text/javascript" defer>
        var exportlist = new Array();
        var exlst = new Array();
        var fieldlist = {
            "a": "位号",
            "b": "呼号",
            "c": "日期时间",
            "d": "频率",
            "e": "模式",
            "f": "信号",
            "g": "对方设备",
            "h": "对方功率",
            "i": "对方天线",
            "j": "对方台址",
            "k": "己方设备",
            "l": "己方功率",
            "m": "己方天线",
            "n": "己方台址",
            "o": "备注"
        };
        function checkclick(cb, a) {
            exportlist = exportlist.filter(i => i !== a);
            exlst = exlst.filter(i => i !== fieldlist[a]);
            if (cb.checked) {
                exportlist.push(a);
                exlst.push(fieldlist[a]);
            }
            document.getElementById("exlst").innerHTML = exlst.join();
        }
    </script>
</head>

<body>
    <h1>导出 - 业余无线电通联记录助手</h1>
    <a href="javascript:void(0);" onclick="location.assign(`http:&#47;&#47;${window.location.host}&#47;`)">返回主页</a>
    <p>文件: {{ .Name }}.hjl</p>
    <div>
        <div>
            <input type="checkbox" id="bjt">
            <label for="bjt">仅保存北京时间hh:mm</label>
        </div>
        <div>
            <b>
                <span>导出字段顺序: </span>
                <span id="exlst"></span>
            </b>
        </div>
        <div>
            <input type="button" onclick="window.open('/getadif?n={{ .Name }}')" value="ADIF">
            <input type="button"
                onclick="window.open('/getcsv?n={{ .Name }}&s='+exportlist.join('')+'&bjthhmm='+(document.getElementById('bjt').checked ? '1' : '0'))"
                value="CSV">
            <input type="button"
                onclick="window.open('/getxlsx?n={{ .Name }}&s='+exportlist.join('')+'&bjthhmm='+(document.getElementById('bjt').checked ? '1' : '0'))"
                value="XLSX">
        </div>
        <table border="1">
            <thead>
                <tr>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'a')" class="sel"
                            id="sel_index">位号</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'b')" class="sel"
                            id="sel_callsign">呼号</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'c')" class="sel"
                            id="sel_dt">日期时间</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'd')" class="sel"
                            id="sel_freq">频率</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'e')" class="sel"
                            id="sel_mode">模式</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'f')" class="sel"
                            id="sel_rst">信号</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'g')" class="sel"
                            id="sel_rrig">对方设备</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'h')" class="sel"
                            id="sel_rpwr">对方功率</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'i')" class="sel"
                            id="sel_rant">对方天线</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'j')" class="sel"
                            id="sel_rqth">对方台址</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'k')" class="sel"
                            id="sel_trig">己方设备</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'l')" class="sel"
                            id="sel_tpwr">己方功率</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'm')" class="sel"
                            id="sel_tant">己方天线</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'n')" class="sel"
                            id="sel_tqth">己方台址</td>
                    <td><input type="checkbox" autocomplete="off" onclick="checkclick(this, 'o')" class="sel"
                            id="sel_rmks">备注</td>
                </tr>
            </thead>
            <tbody>
                {{ range .Data }}
                <tr>
                    <td>{{ .Index }}</td>
                    <td>{{ .Callsign }}</td>
                    <td>{{ .Dt }}</td>
                    <td>{{ .Freq }}</td>
                    <td>{{ .Mode }}</td>
                    <td>{{ .Rst }}</td>
                    <td>{{ .RRig }}</td>
                    <td>{{ .RPwr }}</td>
                    <td>{{ .RAnt }}</td>
                    <td>{{ .RQth }}</td>
                    <td>{{ .TRig }}</td>
                    <td>{{ .TPwr }}</td>
                    <td>{{ .TAnt }}</td>
                    <td>{{ .TQth }}</td>
                    <td>{{ .Rmks }}</td>
                </tr>
                {{ end }}
            </tbody>
        </table>
    </div>
</body>

</html>
